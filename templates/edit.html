<!DOCTYPE html>
<html>
<head>
    <title>Edit Employee</title>
    <link rel="stylesheet" href="/static/editemp.css">
</head>
<body>
    <nav>
        <h2 class="navhd">MANAGE EMPLOYEE & SALARY DETAILS</h2>
    </nav>
    <div class="form-container">
        <form id="salaryForm" method="POST">
            <div class="insideform">
                <h2>Edit Employee</h2>
                ID: <input type="text" readonly name="id" value = "{{ employee[0] }}"><br><br>
                Name: <input type="text" name="name" value="{{ employee[1] }}" required><br><br>
                Salary: <input type="number" readonly name="salary" value="{{ employee[2] }}" required><br><br>
                <!-- deptid: <input type="number" name="deptid" value="{{ employee[3] }}" required><br><br> -->
                Department Name:  <select id="deptid" name="deptid" value="{{ employee[3] }}">
                {% for id, name in dropdown_data %}
                <option value="{{ id }}">{{ id }} - {{ name }}</option>
                {% endfor %}
                </select><br><br>
                Dob: <input type="date" name="dob" value="{{ employee[4] }}" required><br><br>
                Aaadhar: <input type="number" name="aadhaar" value="{{ employee[5] }}" ><br><br>
                Active Status: <select id="activestatus" name="activestatus" value="{{ employee[6] }}">
                <option value="Active">Active</option>
                <option value="Deleted">Deleted</option>
                <option value="Terminated">Terminated</option>
                </select><br><br>

            </div>
            <div class="insideform">
                <h2>Edit Salary Breakup</h2>
                Basic Salary: <input class="calc-input" type="number" name="bssal" value = "{{ employee[7] }}"><br><br>
                House rent Allowance: <input class="calc-input" type="number" name="hra" value = "{{ employee[8] }}"><br><br>
                Leave travel Allowance: <input class="calc-input" type="number" name="lta" value = "{{ employee[9] }}"><br><br>
                Personal Allowance: <input class="calc-input" type="number" name="pa" value = "{{ employee[10] }}"><br><br>
                City Allowance: <input class="calc-input" type="number" name="ca" value = "{{ employee[11] }}"><br><br>
                performance Pay: <input class="calc-input" type="number" name="pp" value = "{{ employee[12] }}"><br><br>
                Total Salary: <input id="total" type="number" readonly name="ts" value = "{{ employee[13] }}"><br><br>
                <button type="submit">Update</button>
            </div>
        </form>
    </div>
 <script>
    document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('salaryForm');
        const inputs = form.querySelectorAll('.calc-input');
        const totalEl = document.getElementById('total'); // could be an input or a span

        function updateTotal() {
            let sum = 0;
            inputs.forEach(inp => {
                const v = parseFloat(inp.value);
                if (!Number.isNaN(v)) sum += v;
            });
            if (totalEl.tagName.toLowerCase() === 'input') {
                totalEl.value = sum;
            } else {
                totalEl.textContent = sum;
            }
        }

        // Update total on input for all current and future inputs with class 'calc-input'
        form.addEventListener('input', (e) => {
            if (e.target && e.target.classList && e.target.classList.contains('calc-input')) {
                updateTotal();
            }
        });

        // Initial calculation
        updateTotal();
    });
</script>  
</body>
</html>